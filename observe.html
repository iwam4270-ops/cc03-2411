<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Observer Console</title>
  <style>
    :root { color-scheme: dark; }
    body{
      margin:0; padding:24px;
      background:#000; color:#00ff88;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      line-height:1.5;
    }
    .wrap{ max-width: 820px; margin:0 auto; }
    .muted{ color:#00c96a; opacity:.9; }
    .panel{
      border:1px solid #00ff88; border-radius:12px;
      padding:16px; margin-top:14px;
      box-shadow: 0 0 0 1px rgba(0,255,136,.15) inset;
    }
    .log{
      min-height: 180px;
      white-space: pre-wrap;
      word-break: break-word;
      overflow:auto;
      max-height: 42vh;
    }
    input, button{
      background:#000; color:#00ff88;
      border:1px solid #00ff88;
      padding:10px 12px; border-radius:10px;
      font: inherit;
    }
    input{ width:min(520px, 100%); }
    button{ cursor:pointer; }
    button:hover{ filter: brightness(1.12); }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:12px; }
    .hint{ margin-top:10px; }
    footer{
      margin-top:18px; font-size:12px;
      color:#00c96a; opacity:.7;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="muted">CASE: CC-03-2411</div>
    <h1 style="margin:6px 0 0;">Observer Console</h1>
    <div class="muted">Observer Console v1.3</div>

    <div class="panel">
      <div id="log" class="log" aria-live="polite"></div>

      <div class="row">
        <label for="answer" class="muted">Enter target designation:</label>
        <input id="answer" type="text" autocomplete="off" spellcheck="false" />
        <button id="submitBtn" type="button">SUBMIT</button>
      </div>

      <div class="hint muted" id="statusLine"></div>
    </div>

    <footer>
      本作はフィクションです。実在の人物・団体・事件とは関係ありません。
    </footer>
  </div>

  <script>
    // =========================
    // 設定（ここだけ編集）
    // =========================
    // 正解（人物名など）：完全一致。ただしスペース有無のみ許容。
    // 例）"小林直樹" を正解にする
    const CORRECT = "小林直樹";

    // Stage2のファイル名（同じフォルダに置く想定）
    const STAGE2 = "stage2.html";

    // =========================
    // ログ演出
    // =========================
    const logEl = document.getElementById("log");
    const statusEl = document.getElementById("statusLine");
    const btn = document.getElementById("submitBtn");
    const input = document.getElementById("answer");

    function ts(){
      const d = new Date();
      const pad = (n)=> String(n).padStart(2,"0");
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }
    function append(line){
      logEl.textContent += `[${ts()}] ${line}\n`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    // 初期ログ
    append("Access detected.");
    append("Memory consistency: 94%");
    append("External observer present.");
    append("STATUS: UNRESOLVED");
    statusEl.textContent = "Input required.";

    // スペース有無のみ許容（全角/半角スペースも吸収）
    function normalizeSpaces(s){
      return String(s ?? "").replace(/[\u0020\u3000]/g, "");
    }

    function check(){
      const raw = input.value ?? "";
      const user = normalizeSpaces(raw);
      const correct = normalizeSpaces(CORRECT);

      if(!user){
        statusEl.textContent = "No input.";
        append("No input received.");
        return;
      }

      // 入力受付ログ（“監視されている感”）
      append("Submission received.");

      if(user === correct){
        statusEl.textContent = "Designation confirmed.";
        append("Designation confirmed.");
        append("Granting access: STAGE2");
        btn.disabled = true;
        input.disabled = true;

        // 少し間を置いて遷移（演出）
        setTimeout(()=> { window.location.href = STAGE2; }, 1200);
      } else {
        statusEl.textContent = "Observation recorded.";
        append("Observation recorded.");
        // 罰は弱く、演出だけ強く
      }
    }

    btn.addEventListener("click", check);
    input.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") check();
    });
  </script>

<script>
(function(){
  const passed = sessionStorage.getItem("cc03_passed")==="1";
  if(!passed){ window.location.replace("index.html"); return; }

  function setOkAndGo(){
    sessionStorage.setItem("cc03_stage2_ok","1");
    window.location.href = "stage2.html";
  }

  const bar = document.createElement("div");
  bar.style.position="fixed";
  bar.style.left="0"; bar.style.right="0"; bar.style.bottom="0";
  bar.style.padding="12px 16px";
  bar.style.background="rgba(0,0,0,.85)";
  bar.style.borderTop="1px solid rgba(0,255,136,.25)";
  bar.style.fontFamily='ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';
  bar.style.color="#00ff88"; bar.style.fontSize="12px";
  bar.style.display="flex"; bar.style.gap="10px";
  bar.style.alignItems="center"; bar.style.justifyContent="space-between";
  bar.style.zIndex="9999";

  const left = document.createElement("div");
  left.textContent = "LOG VIEW / Access recorded";
  left.style.opacity="0.8";

  const right = document.createElement("div");
  right.style.display="flex"; right.style.gap="10px"; right.style.alignItems="center";

  const timer = document.createElement("span");
  timer.style.opacity="0.75";

  const btn = document.createElement("button");
  btn.textContent = "CONTINUE";
  btn.style.cursor="pointer";
  btn.style.padding="8px 12px";
  btn.style.borderRadius="8px";
  btn.style.border="1px solid rgba(0,255,136,.35)";
  btn.style.background="rgba(0,255,136,.08)";
  btn.style.color="#00ff88";
  btn.style.fontFamily="inherit";
  btn.style.fontSize="12px";
  btn.addEventListener("click", setOkAndGo);

  right.appendChild(timer); right.appendChild(btn);
  bar.appendChild(left); bar.appendChild(right);
  document.body.appendChild(bar);

  let t = 12;
  timer.textContent = "Auto in " + t + "s";
  const iv = setInterval(()=>{
    t -= 1;
    timer.textContent = "Auto in " + t + "s";
    if(t<=0){ clearInterval(iv); setOkAndGo(); }
  }, 1000);
})();
</script>

</body>
</html>
